{"version":3,"sources":["assets/scripts/GlowInnerV2EffectScene.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAoD,0CAAY;IAAhE;QAAA,qEAuIC;QAtIW,gBAAU,GAAc,IAAI,CAAC;QAC7B,qBAAe,GAAa,IAAI,CAAC;QAEjC,kBAAY,GAAc,IAAI,CAAC;QAC/B,uBAAiB,GAAa,IAAI,CAAC;QAEnC,iBAAW,GAAc,IAAI,CAAC;QAC9B,sBAAgB,GAAa,IAAI,CAAC;QAElC,kBAAY,GAAc,IAAI,CAAC;QAC/B,uBAAiB,GAAa,IAAI,CAAC;QAEnC,sBAAgB,GAAc,IAAI,CAAC;QACnC,2BAAqB,GAAa,IAAI,CAAC;QAEvC,0BAAoB,GAAc,IAAI,CAAC;QACvC,+BAAyB,GAAa,IAAI,CAAC;QAE3C,iBAAW,GAAkB,IAAI,CAAC;;IAoH9C,CAAC;IAlHG,uCAAM,GAAN;QACI,EAAE,CAAC,mBAAmB,CAAC,OAAO,GAAG,KAAK,CAAC;QACvC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC,IAAI,CAAC,8CAA8C,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAClG,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC,IAAI,CAAC,kDAAkD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE1G,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,IAAI,CAAC,gDAAgD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACtG,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE9G,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC,IAAI,CAAC,+CAA+C,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACpG,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE5G,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,IAAI,CAAC,gDAAgD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACtG,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC,IAAI,CAAC,oDAAoD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE9G,IAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC,IAAI,CAAC,+CAA+C,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACzG,IAAI,CAAC,qBAAqB,GAAG,EAAE,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAEjH,IAAI,CAAC,oBAAoB,GAAG,EAAE,CAAC,IAAI,CAAC,mDAAmD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACjH,IAAI,CAAC,yBAAyB,GAAG,EAAE,CAAC,IAAI,CAAC,uDAAuD,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAEzH,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;IACxF,CAAC;IAED,yCAAQ,GAAR;QACI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAC9D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAChE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAChE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QACpE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC5E,CAAC;IAED,0CAAS,GAAT;QACI,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAC/D,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QACjE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QAChE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QACjE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IAC7E,CAAC;IAED,sCAAK,GAAL;QACI,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC5B,CAAC;IAEO,iDAAgB,GAAxB;QACI,kBAAkB;QAClB,IAAI,CAAC,eAAe,CAAC,MAAM,GAAM,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,WAAM,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAG,CAAC;QACvH,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,WAAM,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAG,CAAC;QAC7H,IAAI,CAAC,gBAAgB,CAAC,MAAM,GAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,WAAM,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAG,CAAC;QAC1H,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAM,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,WAAM,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAG,CAAC;QAE7H,IAAI,qBAAqB,GAAG,IAAI,CAAC,gBAAgB,CAAC,QAAQ,GAAG,GAAG,CAAC;QACjE,IAAI,CAAC,qBAAqB,CAAC,MAAM,GAAG,KAAG,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAG,CAAC;QAE1E,4DAA4D;QAC5D,4EAA4E;QAC5E,IAAI,yBAAyB,GAAG,IAAI,CAAC,oBAAoB,CAAC,QAAQ,CAAC;QACnE,IAAI,CAAC,yBAAyB,CAAC,MAAM,GAAG,KAAG,yBAAyB,CAAC,OAAO,CAAC,CAAC,CAAG,CAAC;QAElF,OAAO;QACP,IAAI,CAAC,8BAA8B,CAAC;YAChC,SAAS,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC;YAC7H,SAAS,EAAE,qBAAqB;YAChC,aAAa,EAAE,yBAAyB;SAC3C,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACK,+DAA8B,GAAtC,UAAuC,KAetC;QACG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,SAAS;YAChD,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,UAAC,eAAe;gBAChE,IAAI,eAAe,YAAY,EAAE,CAAC,MAAM,EAAE;oBACtC,IAAI,eAAe,GAAe,eAAgB,CAAC,WAAW,CAAC,OAAO,EAAE,CAAC;oBACzE,IAAI,QAAQ,GAAgB,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBAC3D,QAAQ,CAAC,WAAW,CAAC,aAAa,EAAE,eAAe,CAAC,KAAK,CAAC,CAAC;oBAC3D,QAAQ,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,CAAC,MAAM,CAAC,CAAC;oBAC7D,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;oBACnD,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;oBACnD,QAAQ,CAAC,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;oBAC3D,eAAe,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;iBAC5C;qBAAM;oBACH,IAAI,QAAQ,GAAgB,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBAC3D,QAAQ,CAAC,WAAW,CAAC,aAAa,EAAE,SAAS,CAAC,KAAK,CAAC,CAAC;oBACrD,QAAQ,CAAC,WAAW,CAAC,cAAc,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC;oBACvD,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;oBACnD,QAAQ,CAAC,WAAW,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC;oBACnD,QAAQ,CAAC,WAAW,CAAC,eAAe,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;oBAC3D,eAAe,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;iBAC5C;YACL,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAtIgB,sBAAsB;QAD1C,OAAO;OACa,sBAAsB,CAuI1C;IAAD,6BAAC;CAvID,AAuIC,CAvImD,EAAE,CAAC,SAAS,GAuI/D;kBAvIoB,sBAAsB","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class GlowInnerV2EffectScene extends cc.Component {\n    private _redSlider: cc.Slider = null;\n    private _redSliderLabel: cc.Label = null;\n\n    private _greenSlider: cc.Slider = null;\n    private _greenSliderLabel: cc.Label = null;\n\n    private _blueSlider: cc.Slider = null;\n    private _blueSliderLabel: cc.Label = null;\n\n    private _alphaSlider: cc.Slider = null;\n    private _alphaSliderLabel: cc.Label = null;\n\n    private _glowWidthSlider: cc.Slider = null;\n    private _glowWidthSliderLabel: cc.Label = null;\n\n    private _glowThresholdSlider: cc.Slider = null;\n    private _glowThresholdSliderLabel: cc.Label = null;\n\n    private _scrollView: cc.ScrollView = null;\n\n    onLoad() {\n        cc.dynamicAtlasManager.enabled = false;\n        this._redSlider = cc.find(\"Canvas/Content/Sliders/ColorRedSlider/Slider\").getComponent(cc.Slider);\n        this._redSliderLabel = cc.find(\"Canvas/Content/Sliders/ColorRedSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._greenSlider = cc.find(\"Canvas/Content/Sliders/ColorGreenSlider/Slider\").getComponent(cc.Slider);\n        this._greenSliderLabel = cc.find(\"Canvas/Content/Sliders/ColorGreenSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._blueSlider = cc.find(\"Canvas/Content/Sliders/ColorBlueSlider/Slider\").getComponent(cc.Slider);\n        this._blueSliderLabel = cc.find(\"Canvas/Content/Sliders/ColorBlueSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._alphaSlider = cc.find(\"Canvas/Content/Sliders/ColorAlphaSlider/Slider\").getComponent(cc.Slider);\n        this._alphaSliderLabel = cc.find(\"Canvas/Content/Sliders/ColorAlphaSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._glowWidthSlider = cc.find(\"Canvas/Content/Sliders/GlowWidthSlider/Slider\").getComponent(cc.Slider);\n        this._glowWidthSliderLabel = cc.find(\"Canvas/Content/Sliders/GlowWidthSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._glowThresholdSlider = cc.find(\"Canvas/Content/Sliders/GlowThresholdSlider/Slider\").getComponent(cc.Slider);\n        this._glowThresholdSliderLabel = cc.find(\"Canvas/Content/Sliders/GlowThresholdSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._scrollView = cc.find(\"Canvas/Content/ScrollView\").getComponent(cc.ScrollView);\n    }\n\n    onEnable() {\n        this._redSlider.node.on(\"slide\", this._onSliderChanged, this);\n        this._greenSlider.node.on(\"slide\", this._onSliderChanged, this);\n        this._blueSlider.node.on(\"slide\", this._onSliderChanged, this);\n        this._alphaSlider.node.on(\"slide\", this._onSliderChanged, this);\n        this._glowWidthSlider.node.on(\"slide\", this._onSliderChanged, this);\n        this._glowThresholdSlider.node.on(\"slide\", this._onSliderChanged, this);\n    }\n\n    onDisable() {\n        this._redSlider.node.off(\"slide\", this._onSliderChanged, this);\n        this._greenSlider.node.off(\"slide\", this._onSliderChanged, this);\n        this._blueSlider.node.off(\"slide\", this._onSliderChanged, this);\n        this._alphaSlider.node.off(\"slide\", this._onSliderChanged, this);\n        this._glowWidthSlider.node.off(\"slide\", this._onSliderChanged, this);\n        this._glowThresholdSlider.node.off(\"slide\", this._onSliderChanged, this);\n    }\n\n    start() {\n        this._onSliderChanged();\n    }\n\n    private _onSliderChanged() {\n        // 更新进度条值 Label 文本\n        this._redSliderLabel.string = `${this._redSlider.progress.toFixed(2)} | ${Math.round(255 * this._redSlider.progress)}`;\n        this._greenSliderLabel.string = `${this._greenSlider.progress.toFixed(2)} | ${Math.round(255 * this._greenSlider.progress)}`;\n        this._blueSliderLabel.string = `${this._blueSlider.progress.toFixed(2)} | ${Math.round(255 * this._blueSlider.progress)}`;\n        this._alphaSliderLabel.string = `${this._alphaSlider.progress.toFixed(2)} | ${Math.round(255 * this._alphaSlider.progress)}`;\n\n        let realGlowWidthProgress = this._glowWidthSlider.progress * 200;\n        this._glowWidthSliderLabel.string = `${realGlowWidthProgress.toFixed(0)}`;\n\n        // 这里为约束一下值发光阈值值在 [0.0, 0.5] 因为 0.5+ 之后的效果可能就是其他效果，也可以自己修改这里\n        // let realGlowThresholdProgress = this._glowThresholdSlider.progress * 0.5;\n        let realGlowThresholdProgress = this._glowThresholdSlider.progress;\n        this._glowThresholdSliderLabel.string = `${realGlowThresholdProgress.toFixed(2)}`;\n\n        // 更新材质\n        this._updateRenderComponentMaterial({\n            glowColor: cc.v4(this._redSlider.progress, this._greenSlider.progress, this._blueSlider.progress, this._alphaSlider.progress),\n            glowRange: realGlowWidthProgress,\n            glowThreshold: realGlowThresholdProgress,\n        });\n    }\n\n    /**\n     * 更新渲染组件的材质\n     *\n     * 1. 获取材质\n     * 2. 给材质的 unitform 变量赋值\n     * 3. 重新将材质赋值回去\n     */\n    private _updateRenderComponentMaterial(param: {\n        /**\n         * 发光宽度（px）\n         */\n        glowRange: number;\n\n        /**\n         * 发光颜色 [0.0, 1.0]\n         */\n        glowColor: cc.Vec4;\n\n        /**\n         * 发光阈值 [0.0, 1.0]\n         */\n        glowThreshold: number;\n    }) {\n        this._scrollView.content.children.forEach((childNode) => {\n            childNode.getComponents(cc.RenderComponent).forEach((renderComponent) => {\n                if (renderComponent instanceof cc.Sprite) {\n                    let spriteFrameRect = (<cc.Sprite>renderComponent).spriteFrame.getRect();\n                    let material: cc.Material = renderComponent.getMaterial(0);\n                    material.setProperty(\"spriteWidth\", spriteFrameRect.width);\n                    material.setProperty(\"spriteHeight\", spriteFrameRect.height);\n                    material.setProperty(\"glowRange\", param.glowRange);\n                    material.setProperty(\"glowColor\", param.glowColor);\n                    material.setProperty(\"glowThreshold\", param.glowThreshold);\n                    renderComponent.setMaterial(0, material);\n                } else {\n                    let material: cc.Material = renderComponent.getMaterial(0);\n                    material.setProperty(\"spriteWidth\", childNode.width);\n                    material.setProperty(\"spriteHeight\", childNode.height);\n                    material.setProperty(\"glowRange\", param.glowRange);\n                    material.setProperty(\"glowColor\", param.glowColor);\n                    material.setProperty(\"glowThreshold\", param.glowThreshold);\n                    renderComponent.setMaterial(0, material);\n                }\n            });\n        });\n    }\n}\n"]}