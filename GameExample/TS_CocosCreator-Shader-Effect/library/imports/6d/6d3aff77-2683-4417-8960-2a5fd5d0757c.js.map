{"version":3,"sources":["assets/scripts/FlashLightEffectScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import FlashLightCtrlComponent, { FlashLightUBO } from \"./FlashLightCtrlComponent\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class FlashLightEffectScene extends cc.Component {\n    private _redSlider: cc.Slider = null;\n    private _redSliderLabel: cc.Label = null;\n    private _greenSlider: cc.Slider = null;\n    private _greenSliderLabel: cc.Label = null;\n    private _blueSlider: cc.Slider = null;\n    private _blueSliderLabel: cc.Label = null;\n    private _alphaSlider: cc.Slider = null;\n    private _alphaSliderLabel: cc.Label = null;\n    private _lightWidthSlider: cc.Slider = null;\n    private _lightWidthSliderLabel: cc.Label = null;\n    private _lightAngleSlider: cc.Slider = null;\n    private _lightAngleSliderLabel: cc.Label = null;\n\n    private _enableGradientToggle: cc.Toggle = null;\n    private _cropAlphaToggle: cc.Toggle = null;\n    private _enableFogToggle: cc.Toggle = null;\n\n    private _examplesParentNode: cc.Node = null;\n\n    onLoad() {\n        cc.dynamicAtlasManager.enabled = false;\n\n        this._redSlider = cc.find(\"Canvas/Content/Controller/ColorRedSlider/Slider\").getComponent(cc.Slider);\n        this._redSliderLabel = cc.find(\"Canvas/Content/Controller/ColorRedSlider/ValueLabel\").getComponent(cc.Label);\n        this._greenSlider = cc.find(\"Canvas/Content/Controller/ColorGreenSlider/Slider\").getComponent(cc.Slider);\n        this._greenSliderLabel = cc.find(\"Canvas/Content/Controller/ColorGreenSlider/ValueLabel\").getComponent(cc.Label);\n        this._blueSlider = cc.find(\"Canvas/Content/Controller/ColorBlueSlider/Slider\").getComponent(cc.Slider);\n        this._blueSliderLabel = cc.find(\"Canvas/Content/Controller/ColorBlueSlider/ValueLabel\").getComponent(cc.Label);\n        this._alphaSlider = cc.find(\"Canvas/Content/Controller/ColorAlphaSlider/Slider\").getComponent(cc.Slider);\n        this._alphaSliderLabel = cc.find(\"Canvas/Content/Controller/ColorAlphaSlider/ValueLabel\").getComponent(cc.Label);\n        this._lightWidthSlider = cc.find(\"Canvas/Content/Controller/LightWidthSlider/Slider\").getComponent(cc.Slider);\n        this._lightWidthSliderLabel = cc.find(\"Canvas/Content/Controller/LightWidthSlider/ValueLabel\").getComponent(cc.Label);\n        this._lightAngleSlider = cc.find(\"Canvas/Content/Controller/LightAngleSlider/Slider\").getComponent(cc.Slider);\n        this._lightAngleSliderLabel = cc.find(\"Canvas/Content/Controller/LightAngleSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._enableGradientToggle = cc.find(\"Canvas/Content/Controller/EnableGradientToggle/Toggle\").getComponent(cc.Toggle);\n        this._cropAlphaToggle = cc.find(\"Canvas/Content/Controller/CropAlphaToggle/Toggle\").getComponent(cc.Toggle);\n        this._enableFogToggle = cc.find(\"Canvas/Content/Controller/EnableFogToggle/Toggle\").getComponent(cc.Toggle);\n\n        // 代码添加控制脚本\n        this._examplesParentNode = cc.find(\"Canvas/Content/Examples\");\n        this._examplesParentNode.children.forEach(childNode => {\n            childNode.addComponent(FlashLightCtrlComponent);\n        });\n    }\n\n    onEnable() {\n        this._redSlider.node.on(\"slide\", this._onPropertyChanged, this);\n        this._greenSlider.node.on(\"slide\", this._onPropertyChanged, this);\n        this._blueSlider.node.on(\"slide\", this._onPropertyChanged, this);\n        this._alphaSlider.node.on(\"slide\", this._onPropertyChanged, this);\n        this._lightWidthSlider.node.on(\"slide\", this._onPropertyChanged, this);\n        this._lightAngleSlider.node.on(\"slide\", this._onPropertyChanged, this);\n\n        this._enableGradientToggle.node.on(\"toggle\", this._onPropertyChanged, this);\n        this._cropAlphaToggle.node.on(\"toggle\", this._onPropertyChanged, this);\n        this._enableFogToggle.node.on(\"toggle\", this._onPropertyChanged, this);\n    }\n\n    onDisable() {\n        this._redSlider.node.off(\"slide\", this._onPropertyChanged, this);\n        this._greenSlider.node.off(\"slide\", this._onPropertyChanged, this);\n        this._blueSlider.node.off(\"slide\", this._onPropertyChanged, this);\n        this._alphaSlider.node.off(\"slide\", this._onPropertyChanged, this);\n        this._lightWidthSlider.node.off(\"slide\", this._onPropertyChanged, this);\n        this._lightAngleSlider.node.off(\"slide\", this._onPropertyChanged, this);\n\n        this._enableGradientToggle.node.off(\"toggle\", this._onPropertyChanged, this);\n        this._cropAlphaToggle.node.off(\"toggle\", this._onPropertyChanged, this);\n        this._enableFogToggle.node.off(\"toggle\", this._onPropertyChanged, this);\n    }\n\n    start() {\n        this._onPropertyChanged();\n    }\n\n    private _onPropertyChanged() {\n        // 更新进度条值 Label 文本\n        this._redSliderLabel.string = `${this._redSlider.progress.toFixed(2)} | ${Math.round(255 * this._redSlider.progress)}`;\n        this._greenSliderLabel.string = `${this._greenSlider.progress.toFixed(2)} | ${Math.round(255 * this._greenSlider.progress)}`;\n        this._blueSliderLabel.string = `${this._blueSlider.progress.toFixed(2)} | ${Math.round(255 * this._blueSlider.progress)}`;\n        this._alphaSliderLabel.string = `${this._alphaSlider.progress.toFixed(2)} | ${Math.round(255 * this._alphaSlider.progress)}`;\n        this._lightWidthSliderLabel.string = `${this._lightWidthSlider.progress.toFixed(2)}`;\n\n        let angle = 180 * this._lightAngleSlider.progress;\n        this._lightAngleSliderLabel.string = `${this._lightAngleSlider.progress.toFixed(2)} | ${angle.toFixed(2)}`;\n\n        // 通知子节点更新材质\n        this._examplesParentNode.children.forEach(childNode => {\n            childNode.emit(\"on_property_change\", <FlashLightUBO>{\n                lightColor: cc.color(\n                    Math.round(255 * this._redSlider.progress),\n                    Math.round(255 * this._greenSlider.progress),\n                    Math.round(255 * this._blueSlider.progress),\n                    Math.round(255 * this._alphaSlider.progress)\n                ),\n                lightAngle: angle,\n                lightWidth: this._lightWidthSlider.progress,\n                enableGradient: this._enableGradientToggle.isChecked,\n                cropAlpha: this._cropAlphaToggle.isChecked,\n                enableFog: this._enableFogToggle.isChecked\n            });\n        });\n    }\n}\n"]}