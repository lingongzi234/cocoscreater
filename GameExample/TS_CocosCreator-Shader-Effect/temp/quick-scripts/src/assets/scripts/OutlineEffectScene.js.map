{"version":3,"sources":["assets/scripts/OutlineEffectScene.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAgD,sCAAY;IAA5D;QAAA,qEA2DC;QA1DW,kBAAY,GAAc,IAAI,CAAC;QAC/B,uBAAiB,GAAa,IAAI,CAAC;QAEnC,yBAAmB,GAAY,IAAI,CAAC;;IAuDhD,CAAC;IArDG,mCAAM,GAAN;QACI,SAAS;QACT,EAAE,CAAC,mBAAmB,CAAC,OAAO,GAAG,KAAK,CAAC;QAEvC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QACjG,IAAI,CAAC,iBAAiB,GAAG,EAAE,CAAC,IAAI,CAAC,+CAA+C,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAEzG,IAAI,CAAC,mBAAmB,GAAG,EAAE,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;IAClE,CAAC;IAED,qCAAQ,GAAR;QACI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IACpE,CAAC;IAED,sCAAS,GAAT;QACI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;IACrE,CAAC;IAED,kCAAK,GAAL;QACI,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC5B,CAAC;IAEO,6CAAgB,GAAxB;QACI,IAAI,YAAY,GAAG,UAAU,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,GAAG,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7E,IAAI,CAAC,iBAAiB,CAAC,MAAM,GAAG,KAAG,YAAc,CAAC;QAElD,OAAO;QACP,IAAI,CAAC,8BAA8B,CAAC;YAChC,YAAY,EAAE,YAAY;SAC7B,CAAC,CAAC;IACP,CAAC;IAED;;;;;;OAMG;IACK,2DAA8B,GAAtC,UAAuC,KAKtC;QACG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,SAAS;YAC/C,SAAS,CAAC,aAAa,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,UAAA,eAAe;gBAC/D,IAAI,QAAQ,GAAgB,eAAe,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAC3D,QAAQ,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,CAAC,YAAY,CAAC,CAAC;gBACzD,eAAe,CAAC,WAAW,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;YAC7C,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IA1DgB,kBAAkB;QADtC,OAAO;OACa,kBAAkB,CA2DtC;IAAD,yBAAC;CA3DD,AA2DC,CA3D+C,EAAE,CAAC,SAAS,GA2D3D;kBA3DoB,kBAAkB","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class OutlineEffectScene extends cc.Component {\n    private _widthSlider: cc.Slider = null;\n    private _widthSliderLabel: cc.Label = null;\n\n    private _examplesParentNode: cc.Node = null;\n\n    onLoad() {\n        // 关闭动态合图\n        cc.dynamicAtlasManager.enabled = false;\n\n        this._widthSlider = cc.find(\"Canvas/Content/Sliders/WidthSlider/Slider\").getComponent(cc.Slider);\n        this._widthSliderLabel = cc.find(\"Canvas/Content/Sliders/WidthSlider/ValueLabel\").getComponent(cc.Label);\n\n        this._examplesParentNode = cc.find(\"Canvas/Content/Examples\");\n    }\n\n    onEnable() {\n        this._widthSlider.node.on(\"slide\", this._onSliderChanged, this);\n    }\n\n    onDisable() {\n        this._widthSlider.node.off(\"slide\", this._onSliderChanged, this);\n    }\n\n    start() {\n        this._onSliderChanged();\n    }\n\n    private _onSliderChanged() {\n        let outlineWidth = parseFloat((this._widthSlider.progress / 100).toFixed(4));\n        this._widthSliderLabel.string = `${outlineWidth}`;\n\n        // 更新材质\n        this._updateRenderComponentMaterial({\n            outlineWidth: outlineWidth\n        });\n    }\n\n    /**\n     * 更新渲染组件的材质\n     *\n     * 1. 获取材质\n     * 2. 给材质的 unitform 变量赋值\n     * 3. 重新将材质赋值回去\n     */\n    private _updateRenderComponentMaterial(param: {\n        /**\n         * 描边宽度 [0.0, 1.0]，比如：0.5，那么就是宽*0.5 高*0.5\n         */\n        outlineWidth: number;\n    }) {\n        this._examplesParentNode.children.forEach(childNode => {\n            childNode.getComponents(cc.RenderComponent).forEach(renderComponent => {\n                let material: cc.Material = renderComponent.getMaterial(0);\n                material.setProperty(\"outlineWidth\", param.outlineWidth);\n                renderComponent.setMaterial(0, material);\n            });\n        });\n    }\n}\n"]}