
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/cases/demo/cutting-objects.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c822aYVtBVMBo4yXF/8n8eH', 'cutting-objects');
// cases/demo/cutting-objects.js

"use strict";

// http://www.emanueleferonato.com/2011/08/05/slicing-splitting-and-cutting-objects-with-box2d-part-4-using-real-graphics/
var EPSILON = 0.1;
var POINT_SQR_EPSILON = 5;

function compare(a, b) {
  if (a.fraction > b.fraction) {
    return 1;
  } else if (a.fraction < b.fraction) {
    return -1;
  }

  return 0;
}

function equals(a, b, epsilon) {
  epsilon = epsilon === undefined ? EPSILON : epsilon;
  return Math.abs(a - b) < epsilon;
}

function equalsVec2(a, b, epsilon) {
  return equals(a.x, b.x, epsilon) && equals(a.y, b.y, epsilon);
}

function pointInLine(point, a, b) {
  return cc.Intersection.pointLineDistance(point, a, b, true) < 1;
}

cc.Class({
  "extends": cc.Component,
  onEnable: function onEnable() {
    this.debugDrawFlags = cc.director.getPhysicsManager().debugDrawFlags;
    cc.director.getPhysicsManager().debugDrawFlags = cc.PhysicsManager.DrawBits.e_jointBit | cc.PhysicsManager.DrawBits.e_shapeBit;
  },
  onDisable: function onDisable() {
    cc.director.getPhysicsManager().debugDrawFlags = this.debugDrawFlags;
  },
  // use this for initialization
  onLoad: function onLoad() {
    var canvas = cc.find('Canvas');
    canvas.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);
    canvas.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);
    canvas.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);
    this.ctx = this.getComponent(cc.Graphics);
  },
  onTouchStart: function onTouchStart(event) {
    this.touching = true;
    this.r1 = this.r2 = this.results = null;
    this.touchStartPoint = this.touchPoint = cc.v2(event.touch.getLocation());
  },
  onTouchMove: function onTouchMove(event) {
    this.touchPoint = cc.v2(event.touch.getLocation());
  },
  onTouchEnd: function onTouchEnd(event) {
    this.touchPoint = cc.v2(event.touch.getLocation());
    this.recalcResults();
    this.touching = false;
    var point = cc.v2(event.touch.getLocation());
    if (equals(this.touchStartPoint.sub(point).magSqr(), 0)) return; // recalculate fraction, make fraction from one direction

    this.r2.forEach(function (r) {
      r.fraction = 1 - r.fraction;
    });
    var results = this.results;
    var pairs = [];

    var _loop = function _loop(i) {
      var find = false;
      var result = results[i];

      for (var _j3 = 0; _j3 < pairs.length; _j3++) {
        var _pair = pairs[_j3];

        if (_pair[0] && result.collider === _pair[0].collider) {
          find = true; // one collider may contains several fixtures, so raycast may through the inner fixture side
          // we need remove them from the result

          var r = _pair.find(function (r) {
            return r.point.sub(result.point).magSqr() <= POINT_SQR_EPSILON;
          });

          if (r) {
            _pair.splice(_pair.indexOf(r), 1);
          } else {
            _pair.push(result);
          }

          break;
        }
      }

      if (!find) {
        pairs.push([result]);
      }
    };

    for (var i = 0; i < results.length; i++) {
      _loop(i);
    }

    for (var _i = 0; _i < pairs.length; _i++) {
      var pair = pairs[_i];

      if (pair.length < 2) {
        continue;
      } // sort pair with fraction


      pair = pair.sort(compare);
      var splitResults = []; // first calculate all results, not split collider right now

      for (var j = 0; j < pair.length - 1; j += 2) {
        var r1 = pair[j];
        var r2 = pair[j + 1];

        if (r1 && r2) {
          this.split(r1.collider, r1.point, r2.point, splitResults);
        }
      }

      if (splitResults.length <= 0) {
        continue;
      }

      var collider = pair[0].collider;
      var maxPointsResult = void 0;

      for (var _j = 0; _j < splitResults.length; _j++) {
        var splitResult = splitResults[_j];

        for (var k = 0; k < splitResult.length; k++) {
          if (typeof splitResult[k] === 'number') {
            splitResult[k] = collider.points[splitResult[k]];
          }
        }

        if (!maxPointsResult || splitResult.length > maxPointsResult.length) {
          maxPointsResult = splitResult;
        }
      }

      if (maxPointsResult.length < 3) {
        continue;
      } // keep max length points to origin collider


      collider.points = maxPointsResult;
      collider.apply();
      var body = collider.body;

      for (var _j2 = 0; _j2 < splitResults.length; _j2++) {
        var _splitResult = splitResults[_j2];
        if (_splitResult.length < 3) continue;
        if (_splitResult == maxPointsResult) continue; // create new body

        var node = new cc.Node();
        node.position = body.getWorldPosition();
        node.rotation = body.getWorldRotation();
        node.parent = cc.director.getScene();
        node.addComponent(cc.RigidBody);
        var newCollider = node.addComponent(cc.PhysicsPolygonCollider);
        newCollider.points = _splitResult;
        newCollider.apply();
      }
    }
  },
  split: function split(collider, p1, p2, splitResults) {
    var body = collider.body;
    var points = collider.points; // The manager.rayCast() method returns points in world coordinates, so use the body.getLocalPoint() to convert them to local coordinates.

    p1 = body.getLocalPoint(p1);
    p2 = body.getLocalPoint(p2);
    var newSplitResult1 = [p1, p2];
    var newSplitResult2 = [p2, p1];
    var index1, index2;

    for (var i = 0; i < points.length; i++) {
      var pp1 = points[i];
      var pp2 = i === points.length - 1 ? points[0] : points[i + 1];

      if (index1 === undefined && pointInLine(p1, pp1, pp2)) {
        index1 = i;
      } else if (index2 === undefined && pointInLine(p2, pp1, pp2)) {
        index2 = i;
      }

      if (index1 !== undefined && index2 !== undefined) {
        break;
      }
    } // console.log(index1 + ' : ' + index2);


    if (index1 === undefined || index2 === undefined) {
      debugger;
      return;
    }

    var splitResult,
        indiceIndex1 = index1,
        indiceIndex2 = index2;

    if (splitResults.length > 0) {
      for (var _i2 = 0; _i2 < splitResults.length; _i2++) {
        var indices = splitResults[_i2];
        indiceIndex1 = indices.indexOf(index1);
        indiceIndex2 = indices.indexOf(index2);

        if (indiceIndex1 !== -1 && indiceIndex2 !== -1) {
          splitResult = splitResults.splice(_i2, 1)[0];
          break;
        }
      }
    }

    if (!splitResult) {
      splitResult = points.map(function (p, i) {
        return i;
      });
    }

    for (var _i3 = indiceIndex1 + 1; _i3 !== indiceIndex2 + 1; _i3++) {
      if (_i3 >= splitResult.length) {
        _i3 = 0;
      }

      var p = splitResult[_i3];
      p = typeof p === 'number' ? points[p] : p;

      if (p.sub(p1).magSqr() < POINT_SQR_EPSILON || p.sub(p2).magSqr() < POINT_SQR_EPSILON) {
        continue;
      }

      newSplitResult2.push(splitResult[_i3]);
    }

    for (var _i4 = indiceIndex2 + 1; _i4 !== indiceIndex1 + 1; _i4++) {
      if (_i4 >= splitResult.length) {
        _i4 = 0;
      }

      var _p = splitResult[_i4];
      _p = typeof _p === 'number' ? points[_p] : _p;

      if (_p.sub(p1).magSqr() < POINT_SQR_EPSILON || _p.sub(p2).magSqr() < POINT_SQR_EPSILON) {
        continue;
      }

      newSplitResult1.push(splitResult[_i4]);
    }

    splitResults.push(newSplitResult1);
    splitResults.push(newSplitResult2);
  },
  recalcResults: function recalcResults() {
    if (!this.touching) return;
    var startPoint = this.touchStartPoint;
    var point = this.touchPoint;
    this.ctx.clear();
    this.ctx.moveTo(this.touchStartPoint.x, this.touchStartPoint.y);
    this.ctx.lineTo(point.x, point.y);
    this.ctx.stroke();
    var manager = cc.director.getPhysicsManager(); // manager.rayCast() method calls this function only when it sees that a given line gets into the body - it doesnt see when the line gets out of it.
    // I must have 2 intersection points with a body so that it can be sliced, thats why I use manager.rayCast() again, but this time from B to A - that way the point, at which BA enters the body is the point at which AB leaves it!

    var r1 = manager.rayCast(this.touchStartPoint, point, cc.RayCastType.All);
    var r2 = manager.rayCast(point, this.touchStartPoint, cc.RayCastType.All);
    var results = r1.concat(r2);

    for (var i = 0; i < results.length; i++) {
      var p = results[i].point;
      this.ctx.circle(p.x, p.y, 5);
    }

    this.ctx.fill();
    this.r1 = r1;
    this.r2 = r2;
    this.results = results;
  },
  // called every frame, uncomment this function to activate update callback
  update: function update(dt) {
    // body maybe moving, need calc raycast results in update
    this.recalcResults();
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9jYXNlcy9kZW1vL2N1dHRpbmctb2JqZWN0cy5qcyJdLCJuYW1lcyI6WyJFUFNJTE9OIiwiUE9JTlRfU1FSX0VQU0lMT04iLCJjb21wYXJlIiwiYSIsImIiLCJmcmFjdGlvbiIsImVxdWFscyIsImVwc2lsb24iLCJ1bmRlZmluZWQiLCJNYXRoIiwiYWJzIiwiZXF1YWxzVmVjMiIsIngiLCJ5IiwicG9pbnRJbkxpbmUiLCJwb2ludCIsImNjIiwiSW50ZXJzZWN0aW9uIiwicG9pbnRMaW5lRGlzdGFuY2UiLCJDbGFzcyIsIkNvbXBvbmVudCIsIm9uRW5hYmxlIiwiZGVidWdEcmF3RmxhZ3MiLCJkaXJlY3RvciIsImdldFBoeXNpY3NNYW5hZ2VyIiwiUGh5c2ljc01hbmFnZXIiLCJEcmF3Qml0cyIsImVfam9pbnRCaXQiLCJlX3NoYXBlQml0Iiwib25EaXNhYmxlIiwib25Mb2FkIiwiY2FudmFzIiwiZmluZCIsIm9uIiwiTm9kZSIsIkV2ZW50VHlwZSIsIlRPVUNIX1NUQVJUIiwib25Ub3VjaFN0YXJ0IiwiVE9VQ0hfRU5EIiwib25Ub3VjaEVuZCIsIlRPVUNIX01PVkUiLCJvblRvdWNoTW92ZSIsImN0eCIsImdldENvbXBvbmVudCIsIkdyYXBoaWNzIiwiZXZlbnQiLCJ0b3VjaGluZyIsInIxIiwicjIiLCJyZXN1bHRzIiwidG91Y2hTdGFydFBvaW50IiwidG91Y2hQb2ludCIsInYyIiwidG91Y2giLCJnZXRMb2NhdGlvbiIsInJlY2FsY1Jlc3VsdHMiLCJzdWIiLCJtYWdTcXIiLCJmb3JFYWNoIiwiciIsInBhaXJzIiwiaSIsInJlc3VsdCIsImoiLCJsZW5ndGgiLCJwYWlyIiwiY29sbGlkZXIiLCJzcGxpY2UiLCJpbmRleE9mIiwicHVzaCIsInNvcnQiLCJzcGxpdFJlc3VsdHMiLCJzcGxpdCIsIm1heFBvaW50c1Jlc3VsdCIsInNwbGl0UmVzdWx0IiwiayIsInBvaW50cyIsImFwcGx5IiwiYm9keSIsIm5vZGUiLCJwb3NpdGlvbiIsImdldFdvcmxkUG9zaXRpb24iLCJyb3RhdGlvbiIsImdldFdvcmxkUm90YXRpb24iLCJwYXJlbnQiLCJnZXRTY2VuZSIsImFkZENvbXBvbmVudCIsIlJpZ2lkQm9keSIsIm5ld0NvbGxpZGVyIiwiUGh5c2ljc1BvbHlnb25Db2xsaWRlciIsInAxIiwicDIiLCJnZXRMb2NhbFBvaW50IiwibmV3U3BsaXRSZXN1bHQxIiwibmV3U3BsaXRSZXN1bHQyIiwiaW5kZXgxIiwiaW5kZXgyIiwicHAxIiwicHAyIiwiaW5kaWNlSW5kZXgxIiwiaW5kaWNlSW5kZXgyIiwiaW5kaWNlcyIsIm1hcCIsInAiLCJzdGFydFBvaW50IiwiY2xlYXIiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJtYW5hZ2VyIiwicmF5Q2FzdCIsIlJheUNhc3RUeXBlIiwiQWxsIiwiY29uY2F0IiwiY2lyY2xlIiwiZmlsbCIsInVwZGF0ZSIsImR0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBRUEsSUFBTUEsT0FBTyxHQUFHLEdBQWhCO0FBQ0EsSUFBTUMsaUJBQWlCLEdBQUcsQ0FBMUI7O0FBRUEsU0FBU0MsT0FBVCxDQUFpQkMsQ0FBakIsRUFBb0JDLENBQXBCLEVBQXVCO0VBQ25CLElBQUlELENBQUMsQ0FBQ0UsUUFBRixHQUFhRCxDQUFDLENBQUNDLFFBQW5CLEVBQTZCO0lBQ3pCLE9BQU8sQ0FBUDtFQUNILENBRkQsTUFFTyxJQUFJRixDQUFDLENBQUNFLFFBQUYsR0FBYUQsQ0FBQyxDQUFDQyxRQUFuQixFQUE2QjtJQUNoQyxPQUFPLENBQUMsQ0FBUjtFQUVIOztFQUNELE9BQU8sQ0FBUDtBQUNIOztBQUVELFNBQVNDLE1BQVQsQ0FBaUJILENBQWpCLEVBQW9CQyxDQUFwQixFQUF1QkcsT0FBdkIsRUFBZ0M7RUFDNUJBLE9BQU8sR0FBR0EsT0FBTyxLQUFLQyxTQUFaLEdBQXdCUixPQUF4QixHQUFrQ08sT0FBNUM7RUFDQSxPQUFPRSxJQUFJLENBQUNDLEdBQUwsQ0FBU1AsQ0FBQyxHQUFDQyxDQUFYLElBQWdC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QVQ7SUFFQSxLQUFLcEUsRUFBTCxHQUFVQSxFQUFWO0lBQ0EsS0FBS0MsRUFBTCxHQUFVQSxFQUFWO0lBQ0EsS0FBS0MsT0FBTCxHQUFlQSxPQUFmO0VBQ0gsQ0FyUkk7RUF1Ukw7RUFDQW1FLE1BQU0sRUFBRSxnQkFBVUMsRUFBVixFQUFjO0lBQ2xCO0lBQ0EsS0FBSzlELGFBQUw7RUFDSDtBQTNSSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvLyBodHRwOi8vd3d3LmVtYW51ZWxlZmVyb25hdG8uY29tLzIwMTEvMDgvMDUvc2xpY2luZy1zcGxpdHRpbmctYW5kLWN1dHRpbmctb2JqZWN0cy13aXRoLWJveDJkLXBhcnQtNC11c2luZy1yZWFsLWdyYXBoaWNzL1xuXG5jb25zdCBFUFNJTE9OID0gMC4xO1xuY29uc3QgUE9JTlRfU1FSX0VQU0lMT04gPSA1O1xuXG5mdW5jdGlvbiBjb21wYXJlKGEsIGIpIHtcbiAgICBpZiAoYS5mcmFjdGlvbiA+IGIuZnJhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChhLmZyYWN0aW9uIDwgYi5mcmFjdGlvbikge1xuICAgICAgICByZXR1cm4gLTE7XG5cbiAgICB9XG4gICAgcmV0dXJuIDA7XG59XG5cbmZ1bmN0aW9uIGVxdWFscyAoYSwgYiwgZXBzaWxvbikge1xuICAgIGVwc2lsb24gPSBlcHNpbG9uID09PSB1bmRlZmluZWQgPyBFUFNJTE9OIDogZXBzaWxvbjtcbiAgICByZXR1cm4gTWF0aC5hYnMoYS1iKSA8IGVwc2lsb247XG59XG5cbmZ1bmN0aW9uIGVxdWFsc1ZlYzIoYSxiLCBlcHNpbG9uKSB7XG4gICAgcmV0dXJuIGVxdWFscyhhLngsIGIueCwgZXBzaWxvbikgJiYgZXF1YWxzKGEueSwgYi55LCBlcHNpbG9uKTtcbn1cblxuZnVuY3Rpb24gcG9pbnRJbkxpbmUgKHBvaW50LCBhLCBiKSB7XG4gICAgcmV0dXJuIGNjLkludGVyc2VjdGlvbi5wb2ludExpbmVEaXN0YW5jZShwb2ludCwgYSwgYiwgdHJ1ZSkgPCAxO1xufVxuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgb25FbmFibGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5kZWJ1Z0RyYXdGbGFncyA9IGNjLmRpcmVjdG9yLmdldFBoeXNpY3NNYW5hZ2VyKCkuZGVidWdEcmF3RmxhZ3M7XG4gICAgICAgIGNjLmRpcmVjdG9yLmdldFBoeXNpY3NNYW5hZ2VyKCkuZGVidWdEcmF3RmxhZ3MgPSBcbiAgICAgICAgICAgIGNjLlBoeXNpY3NNYW5hZ2VyLkRyYXdCaXRzLmVfam9pbnRCaXQgfFxuICAgICAgICAgICAgY2MuUGh5c2ljc01hbmFnZXIuRHJhd0JpdHMuZV9zaGFwZUJpdFxuICAgICAgICAgICAgO1xuICAgIH0sXG5cbiAgICBvbkRpc2FibGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2MuZGlyZWN0b3IuZ2V0UGh5c2ljc01hbmFnZXIoKS5kZWJ1Z0RyYXdGbGFncyA9IHRoaXMuZGVidWdEcmF3RmxhZ3M7XG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2FudmFzID0gY2MuZmluZCgnQ2FudmFzJyk7XG4gICAgICAgIGNhbnZhcy5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5vblRvdWNoU3RhcnQsIHRoaXMpO1xuICAgICAgICBjYW52YXMub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLm9uVG91Y2hFbmQsIHRoaXMpO1xuICAgICAgICBjYW52YXMub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgdGhpcy5vblRvdWNoTW92ZSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5jdHggPSB0aGlzLmdldENvbXBvbmVudChjYy5HcmFwaGljcyk7XG4gICAgfSxcblxuICAgIG9uVG91Y2hTdGFydDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMudG91Y2hpbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLnIxID0gdGhpcy5yMiA9IHRoaXMucmVzdWx0cyA9IG51bGw7XG4gICAgICAgIHRoaXMudG91Y2hTdGFydFBvaW50ID0gdGhpcy50b3VjaFBvaW50ID0gY2MudjIoIGV2ZW50LnRvdWNoLmdldExvY2F0aW9uKCkgKTtcbiAgICB9LFxuXG4gICAgb25Ub3VjaE1vdmU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLnRvdWNoUG9pbnQgPSBjYy52MiggZXZlbnQudG91Y2guZ2V0TG9jYXRpb24oKSApO1xuICAgIH0sXG5cbiAgICBvblRvdWNoRW5kOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy50b3VjaFBvaW50ID0gY2MudjIoIGV2ZW50LnRvdWNoLmdldExvY2F0aW9uKCkgKTtcbiAgICAgICAgdGhpcy5yZWNhbGNSZXN1bHRzKCk7XG4gICAgICAgIHRoaXMudG91Y2hpbmcgPSBmYWxzZTtcblxuICAgICAgICBsZXQgcG9pbnQgPSBjYy52MiggZXZlbnQudG91Y2guZ2V0TG9jYXRpb24oKSApO1xuICAgICAgICBpZiAoIGVxdWFscyh0aGlzLnRvdWNoU3RhcnRQb2ludC5zdWIocG9pbnQpLm1hZ1NxcigpLCAwKSApIHJldHVybjtcblxuICAgICAgICAvLyByZWNhbGN1bGF0ZSBmcmFjdGlvbiwgbWFrZSBmcmFjdGlvbiBmcm9tIG9uZSBkaXJlY3Rpb25cbiAgICAgICAgdGhpcy5yMi5mb3JFYWNoKHIgPT4ge1xuICAgICAgICAgICAgci5mcmFjdGlvbiA9IDEgLSByLmZyYWN0aW9uO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgcmVzdWx0cyA9IHRoaXMucmVzdWx0cztcblxuICAgICAgICBsZXQgcGFpcnMgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbGV0IGZpbmQgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSByZXN1bHRzW2ldO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHBhaXJzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhaXIgPSBwYWlyc1tqXTtcbiAgICAgICAgICAgICAgICBpZiAocGFpclswXSAmJiByZXN1bHQuY29sbGlkZXIgPT09IHBhaXJbMF0uY29sbGlkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluZCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gb25lIGNvbGxpZGVyIG1heSBjb250YWlucyBzZXZlcmFsIGZpeHR1cmVzLCBzbyByYXljYXN0IG1heSB0aHJvdWdoIHRoZSBpbm5lciBmaXh0dXJlIHNpZGVcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgbmVlZCByZW1vdmUgdGhlbSBmcm9tIHRoZSByZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgbGV0IHIgPSBwYWlyLmZpbmQoKHIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByLnBvaW50LnN1YihyZXN1bHQucG9pbnQpLm1hZ1NxcigpIDw9IFBPSU5UX1NRUl9FUFNJTE9OO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFpci5zcGxpY2UocGFpci5pbmRleE9mKHIpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICBwYWlyLnB1c2gocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFmaW5kKSB7XG4gICAgICAgICAgICAgICAgcGFpcnMucHVzaChbcmVzdWx0XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgcGFpciA9IHBhaXJzW2ldO1xuICAgICAgICAgICAgaWYgKHBhaXIubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBzb3J0IHBhaXIgd2l0aCBmcmFjdGlvblxuICAgICAgICAgICAgcGFpciA9IHBhaXIuc29ydChjb21wYXJlKTtcblxuICAgICAgICAgICAgbGV0IHNwbGl0UmVzdWx0cyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBmaXJzdCBjYWxjdWxhdGUgYWxsIHJlc3VsdHMsIG5vdCBzcGxpdCBjb2xsaWRlciByaWdodCBub3dcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgKHBhaXIubGVuZ3RoIC0gMSk7IGogKz0yKSB7XG4gICAgICAgICAgICAgICAgbGV0IHIxID0gcGFpcltqXTtcbiAgICAgICAgICAgICAgICBsZXQgcjIgPSBwYWlyW2orMV07XG5cbiAgICAgICAgICAgICAgICBpZiAocjEgJiYgcjIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGxpdChyMS5jb2xsaWRlciwgcjEucG9pbnQsIHIyLnBvaW50LCBzcGxpdFJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNwbGl0UmVzdWx0cy5sZW5ndGggPD0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgY29sbGlkZXIgPSBwYWlyWzBdLmNvbGxpZGVyO1xuXG4gICAgICAgICAgICBsZXQgbWF4UG9pbnRzUmVzdWx0O1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzcGxpdFJlc3VsdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgc3BsaXRSZXN1bHQgPSBzcGxpdFJlc3VsdHNbal07XG5cbiAgICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHNwbGl0UmVzdWx0Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3BsaXRSZXN1bHRba10gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcGxpdFJlc3VsdFtrXSA9IGNvbGxpZGVyLnBvaW50c1tzcGxpdFJlc3VsdFtrXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIW1heFBvaW50c1Jlc3VsdCB8fCBzcGxpdFJlc3VsdC5sZW5ndGggPiBtYXhQb2ludHNSZXN1bHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heFBvaW50c1Jlc3VsdCA9IHNwbGl0UmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1heFBvaW50c1Jlc3VsdC5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGtlZXAgbWF4IGxlbmd0aCBwb2ludHMgdG8gb3JpZ2luIGNvbGxpZGVyXG4gICAgICAgICAgICBjb2xsaWRlci5wb2ludHMgPSBtYXhQb2ludHNSZXN1bHQ7XG4gICAgICAgICAgICBjb2xsaWRlci5hcHBseSgpO1xuXG4gICAgICAgICAgICBsZXQgYm9keSA9IGNvbGxpZGVyLmJvZHk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc3BsaXRSZXN1bHRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgbGV0IHNwbGl0UmVzdWx0ID0gc3BsaXRSZXN1bHRzW2pdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNwbGl0UmVzdWx0Lmxlbmd0aCA8IDMpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGlmIChzcGxpdFJlc3VsdCA9PSBtYXhQb2ludHNSZXN1bHQpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIG5ldyBib2R5XG4gICAgICAgICAgICAgICAgbGV0IG5vZGUgPSBuZXcgY2MuTm9kZSgpO1xuICAgICAgICAgICAgICAgIG5vZGUucG9zaXRpb24gPSBib2R5LmdldFdvcmxkUG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICBub2RlLnJvdGF0aW9uID0gYm9keS5nZXRXb3JsZFJvdGF0aW9uKCk7XG4gICAgICAgICAgICAgICAgbm9kZS5wYXJlbnQgPSBjYy5kaXJlY3Rvci5nZXRTY2VuZSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG5vZGUuYWRkQ29tcG9uZW50KGNjLlJpZ2lkQm9keSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IG5ld0NvbGxpZGVyID0gbm9kZS5hZGRDb21wb25lbnQoY2MuUGh5c2ljc1BvbHlnb25Db2xsaWRlcik7XG4gICAgICAgICAgICAgICAgbmV3Q29sbGlkZXIucG9pbnRzID0gc3BsaXRSZXN1bHQ7XG4gICAgICAgICAgICAgICAgbmV3Q29sbGlkZXIuYXBwbHkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfSxcblxuICAgIHNwbGl0OiBmdW5jdGlvbiAoY29sbGlkZXIsIHAxLCBwMiwgc3BsaXRSZXN1bHRzKSB7XG4gICAgICAgIGxldCBib2R5ID0gY29sbGlkZXIuYm9keTtcbiAgICAgICAgbGV0IHBvaW50cyA9IGNvbGxpZGVyLnBvaW50cztcblxuXG4gICAgICAgIC8vIFRoZSBtYW5hZ2VyLnJheUNhc3QoKSBtZXRob2QgcmV0dXJucyBwb2ludHMgaW4gd29ybGQgY29vcmRpbmF0ZXMsIHNvIHVzZSB0aGUgYm9keS5nZXRMb2NhbFBvaW50KCkgdG8gY29udmVydCB0aGVtIHRvIGxvY2FsIGNvb3JkaW5hdGVzLlxuICAgICAgICBwMSA9IGJvZHkuZ2V0TG9jYWxQb2ludChwMSk7XG4gICAgICAgIHAyID0gYm9keS5nZXRMb2NhbFBvaW50KHAyKTtcblxuXG4gICAgICAgIGxldCBuZXdTcGxpdFJlc3VsdDEgPSBbcDEsIHAyXTtcbiAgICAgICAgbGV0IG5ld1NwbGl0UmVzdWx0MiA9IFtwMiwgcDFdO1xuXG4gICAgICAgIGxldCBpbmRleDEsIGluZGV4MjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBwcDEgPSBwb2ludHNbaV07XG4gICAgICAgICAgICBsZXQgcHAyID0gaSA9PT0gcG9pbnRzLmxlbmd0aCAtIDEgPyBwb2ludHNbMF0gOiBwb2ludHNbaSsxXTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChpbmRleDEgPT09IHVuZGVmaW5lZCAmJiBwb2ludEluTGluZShwMSwgcHAxLCBwcDIpKSB7XG4gICAgICAgICAgICAgICAgaW5kZXgxID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGluZGV4MiA9PT0gdW5kZWZpbmVkICYmIHBvaW50SW5MaW5lKHAyLCBwcDEsIHBwMikpIHtcbiAgICAgICAgICAgICAgICBpbmRleDIgPSBpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW5kZXgxICE9PSB1bmRlZmluZWQgJiYgaW5kZXgyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGluZGV4MSArICcgOiAnICsgaW5kZXgyKTtcblxuICAgICAgICBpZiAoaW5kZXgxID09PSB1bmRlZmluZWQgfHwgaW5kZXgyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGRlYnVnZ2VyXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc3BsaXRSZXN1bHQsIGluZGljZUluZGV4MSA9IGluZGV4MSwgaW5kaWNlSW5kZXgyID0gaW5kZXgyO1xuICAgICAgICBpZiAoc3BsaXRSZXN1bHRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3BsaXRSZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGluZGljZXMgPSBzcGxpdFJlc3VsdHNbaV07XG4gICAgICAgICAgICAgICAgaW5kaWNlSW5kZXgxID0gaW5kaWNlcy5pbmRleE9mKGluZGV4MSk7XG4gICAgICAgICAgICAgICAgaW5kaWNlSW5kZXgyID0gaW5kaWNlcy5pbmRleE9mKGluZGV4Mik7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNlSW5kZXgxICE9PSAtMSAmJiBpbmRpY2VJbmRleDIgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwbGl0UmVzdWx0ID0gc3BsaXRSZXN1bHRzLnNwbGljZShpLCAxKVswXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzcGxpdFJlc3VsdCkge1xuICAgICAgICAgICAgc3BsaXRSZXN1bHQgPSBwb2ludHMubWFwKChwLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IGkgPSBpbmRpY2VJbmRleDEgKyAxOyBpICE9PSAoaW5kaWNlSW5kZXgyKzEpOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChpID49IHNwbGl0UmVzdWx0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGkgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsZXQgcCA9IHNwbGl0UmVzdWx0W2ldO1xuICAgICAgICAgICAgcCA9IHR5cGVvZiBwID09PSAnbnVtYmVyJyA/IHBvaW50c1twXSA6IHA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChwLnN1YihwMSkubWFnU3FyKCkgPCBQT0lOVF9TUVJfRVBTSUxPTiB8fCBwLnN1YihwMikubWFnU3FyKCkgPCBQT0lOVF9TUVJfRVBTSUxPTikge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBuZXdTcGxpdFJlc3VsdDIucHVzaChzcGxpdFJlc3VsdFtpXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gaW5kaWNlSW5kZXgyICsgMTsgaSAhPT0gaW5kaWNlSW5kZXgxKzE7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkgPj0gc3BsaXRSZXN1bHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgaSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCBwID0gc3BsaXRSZXN1bHRbaV07XG4gICAgICAgICAgICBwID0gdHlwZW9mIHAgPT09ICdudW1iZXInID8gcG9pbnRzW3BdIDogcDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHAuc3ViKHAxKS5tYWdTcXIoKSA8IFBPSU5UX1NRUl9FUFNJTE9OIHx8IHAuc3ViKHAyKS5tYWdTcXIoKSA8IFBPSU5UX1NRUl9FUFNJTE9OKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ld1NwbGl0UmVzdWx0MS5wdXNoKHNwbGl0UmVzdWx0W2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNwbGl0UmVzdWx0cy5wdXNoKG5ld1NwbGl0UmVzdWx0MSk7XG4gICAgICAgIHNwbGl0UmVzdWx0cy5wdXNoKG5ld1NwbGl0UmVzdWx0Mik7XG4gICAgfSxcblxuICAgIHJlY2FsY1Jlc3VsdHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRvdWNoaW5nKSByZXR1cm47XG5cbiAgICAgICAgbGV0IHN0YXJ0UG9pbnQgPSB0aGlzLnRvdWNoU3RhcnRQb2ludDtcbiAgICAgICAgbGV0IHBvaW50ID0gdGhpcy50b3VjaFBvaW50O1xuXG4gICAgICAgIHRoaXMuY3R4LmNsZWFyKCk7XG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbyh0aGlzLnRvdWNoU3RhcnRQb2ludC54LCB0aGlzLnRvdWNoU3RhcnRQb2ludC55KTtcbiAgICAgICAgdGhpcy5jdHgubGluZVRvKHBvaW50LngsIHBvaW50LnkpO1xuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcblxuICAgICAgICBsZXQgbWFuYWdlciA9IGNjLmRpcmVjdG9yLmdldFBoeXNpY3NNYW5hZ2VyKCk7XG5cbiAgICAgICAgLy8gbWFuYWdlci5yYXlDYXN0KCkgbWV0aG9kIGNhbGxzIHRoaXMgZnVuY3Rpb24gb25seSB3aGVuIGl0IHNlZXMgdGhhdCBhIGdpdmVuIGxpbmUgZ2V0cyBpbnRvIHRoZSBib2R5IC0gaXQgZG9lc250IHNlZSB3aGVuIHRoZSBsaW5lIGdldHMgb3V0IG9mIGl0LlxuICAgICAgICAvLyBJIG11c3QgaGF2ZSAyIGludGVyc2VjdGlvbiBwb2ludHMgd2l0aCBhIGJvZHkgc28gdGhhdCBpdCBjYW4gYmUgc2xpY2VkLCB0aGF0cyB3aHkgSSB1c2UgbWFuYWdlci5yYXlDYXN0KCkgYWdhaW4sIGJ1dCB0aGlzIHRpbWUgZnJvbSBCIHRvIEEgLSB0aGF0IHdheSB0aGUgcG9pbnQsIGF0IHdoaWNoIEJBIGVudGVycyB0aGUgYm9keSBpcyB0aGUgcG9pbnQgYXQgd2hpY2ggQUIgbGVhdmVzIGl0IVxuICAgICAgICBsZXQgcjEgPSBtYW5hZ2VyLnJheUNhc3QodGhpcy50b3VjaFN0YXJ0UG9pbnQsIHBvaW50LCBjYy5SYXlDYXN0VHlwZS5BbGwpO1xuICAgICAgICBsZXQgcjIgPSBtYW5hZ2VyLnJheUNhc3QocG9pbnQsIHRoaXMudG91Y2hTdGFydFBvaW50LCBjYy5SYXlDYXN0VHlwZS5BbGwpO1xuXG4gICAgICAgIGxldCByZXN1bHRzID0gcjEuY29uY2F0KHIyKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGxldCBwID0gcmVzdWx0c1tpXS5wb2ludDtcbiAgICAgICAgICAgIHRoaXMuY3R4LmNpcmNsZShwLngsIHAueSwgNSk7XG4gICAgICAgIH0gIFxuICAgICAgICB0aGlzLmN0eC5maWxsKCk7XG5cbiAgICAgICAgdGhpcy5yMSA9IHIxO1xuICAgICAgICB0aGlzLnIyID0gcjI7XG4gICAgICAgIHRoaXMucmVzdWx0cyA9IHJlc3VsdHM7XG4gICAgfSxcblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgLy8gYm9keSBtYXliZSBtb3ZpbmcsIG5lZWQgY2FsYyByYXljYXN0IHJlc3VsdHMgaW4gdXBkYXRlXG4gICAgICAgIHRoaXMucmVjYWxjUmVzdWx0cygpO1xuICAgIH0sXG59KTtcbiJdfQ==