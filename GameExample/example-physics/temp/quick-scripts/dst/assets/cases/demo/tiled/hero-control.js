
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/cases/demo/tiled/hero-control.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '6fc86RgnPlPjLOL8x/OVTmI', 'hero-control');
// cases/demo/tiled/hero-control.js

"use strict";

// game art from : https://openpixelproject.itch.io/opp2017sprites
var MOVE_LEFT = 1;
var MOVE_RIGHT = 2;
cc.macro.ENABLE_TILEDMAP_CULLING = false;
cc.Class({
  "extends": cc.Component,
  properties: {
    maxSpeed: 500,
    jumps: 2,
    acceleration: 1500,
    jumpSpeed: 200,
    drag: 600
  },
  // use this for initialization
  onLoad: function onLoad() {
    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);
    cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);
    this._moveFlags = 0;
    this._up = false;
    this.body = this.getComponent(cc.RigidBody);
  },
  onKeyDown: function onKeyDown(event) {
    switch (event.keyCode) {
      case cc.KEY.a:
      case cc.KEY.left:
        this._moveFlags |= MOVE_LEFT;
        break;

      case cc.KEY.d:
      case cc.KEY.right:
        this._moveFlags |= MOVE_RIGHT;
        break;

      case cc.KEY.up:
        if (!this._upPressed) {
          this._up = true;
        }

        this._upPressed = true;
        break;
    }
  },
  onKeyUp: function onKeyUp(event) {
    switch (event.keyCode) {
      case cc.KEY.a:
      case cc.KEY.left:
        this._moveFlags &= ~MOVE_LEFT;
        break;

      case cc.KEY.d:
      case cc.KEY.right:
        this._moveFlags &= ~MOVE_RIGHT;
        break;

      case cc.KEY.up:
        this._upPressed = false;
        break;
    }
  },
  // called every frame, uncomment this function to activate update callback
  update: function update(dt) {
    var speed = this.body.linearVelocity;

    if (this._moveFlags === MOVE_LEFT) {
      // this.anim.play('walk');
      if (this.node.scaleX > 0) {
        this.node.scaleX *= -1;
      }

      speed.x -= this.acceleration * dt;

      if (speed.x < -this.maxSpeed) {
        speed.x = -this.maxSpeed;
      }
    } else if (this._moveFlags === MOVE_RIGHT) {
      // this.anim.play('walk');
      if (this.node.scaleX < 0) {
        this.node.scaleX *= -1;
      }

      speed.x += this.acceleration * dt;

      if (speed.x > this.maxSpeed) {
        speed.x = this.maxSpeed;
      }
    } else {
      if (speed.x != 0) {
        var d = this.drag * dt;

        if (Math.abs(speed.x) <= d) {
          speed.x = 0; // this.anim.play('idle');
        } else {
          speed.x -= speed.x > 0 ? d : -d;
        }
      }
    }

    if (Math.abs(speed.y) < 1) {
      this.jumps = 2;
    }

    if (this.jumps > 0 && this._up) {
      speed.y = this.jumpSpeed;
      this.jumps--;
    }

    this._up = false;
    this.body.linearVelocity = speed;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9jYXNlcy9kZW1vL3RpbGVkL2hlcm8tY29udHJvbC5qcyJdLCJuYW1lcyI6WyJNT1ZFX0xFRlQiLCJNT1ZFX1JJR0hUIiwiY2MiLCJtYWNybyIsIkVOQUJMRV9USUxFRE1BUF9DVUxMSU5HIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwibWF4U3BlZWQiLCJqdW1wcyIsImFjY2VsZXJhdGlvbiIsImp1bXBTcGVlZCIsImRyYWciLCJvbkxvYWQiLCJzeXN0ZW1FdmVudCIsIm9uIiwiU3lzdGVtRXZlbnQiLCJFdmVudFR5cGUiLCJLRVlfRE9XTiIsIm9uS2V5RG93biIsIktFWV9VUCIsIm9uS2V5VXAiLCJfbW92ZUZsYWdzIiwiX3VwIiwiYm9keSIsImdldENvbXBvbmVudCIsIlJpZ2lkQm9keSIsImV2ZW50Iiwia2V5Q29kZSIsIktFWSIsImEiLCJsZWZ0IiwiZCIsInJpZ2h0IiwidXAiLCJfdXBQcmVzc2VkIiwidXBkYXRlIiwiZHQiLCJzcGVlZCIsImxpbmVhclZlbG9jaXR5Iiwibm9kZSIsInNjYWxlWCIsIngiLCJNYXRoIiwiYWJzIiwieSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUVBLElBQU1BLFNBQVMsR0FBRyxDQUFsQjtBQUNBLElBQU1DLFVBQVUsR0FBRyxDQUFuQjtBQUVBQyxFQUFFLENBQUNDLEtBQUgsQ0FBU0MsdUJBQVQsR0FBbUMsS0FBbkM7QUFFQUYsRUFBRSxDQUFDRyxLQUFILENBQVM7RUFDTCxXQUFTSCxFQUFFLENBQUNJLFNBRFA7RUFHTEMsVUFBVSxFQUFFO0lBQ1JDLFFBQVEsRUFBRSxHQURGO0lBRVJDLEtBQUssRUFBRSxDQUZDO0lBR1JDLFlBQVksRUFBRSxJQUhOO0lBSVJDLFNBQVMsRUFBRSxHQUpIO0lBS1JDLElBQUksRUFBRTtFQUxFLENBSFA7RUFXTDtFQUNBQyxNQUFNLEVBQUUsa0JBQVk7SUFDaEJYLEVBQUUsQ0FBQ1ksV0FBSCxDQUFlQyxFQUFmLENBQWtCYixF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NEI7UUFDeEI4QixLQUFLLENBQUNJLENBQU4sR0FBVSxLQUFLbEMsUUFBZjtNQUNIO0lBQ0osQ0FYSSxNQVlBO01BQ0QsSUFBRzhCLEtBQUssQ0FBQ0ksQ0FBTixJQUFXLENBQWQsRUFBaUI7UUFDYixJQUFJVixDQUFDLEdBQUcsS0FBS3BCLElBQUwsR0FBWXlCLEVBQXBCOztRQUNBLElBQUdNLElBQUksQ0FBQ0MsR0FBTCxDQUFTTixLQUFLLENBQUNJLENBQWYsS0FBcUJWLENBQXhCLEVBQTJCO1VBQ3ZCTSxLQUFLLENBQUNJLENBQU4sR0FBVSxDQUFWLENBRHVCLENBRXZCO1FBQ0gsQ0FIRCxNQUdPO1VBQ0hKLEtBQUssQ0FBQ0ksQ0FBTixJQUFXSixLQUFLLENBQUNJLENBQU4sR0FBVSxDQUFWLEdBQWNWLENBQWQsR0FBa0IsQ0FBQ0EsQ0FBOUI7UUFDSDtNQUNKO0lBQ0o7O0lBRUQsSUFBR1csSUFBSSxDQUFDQyxHQUFMLENBQVNOLEtBQUssQ0FBQ08sQ0FBZixJQUFvQixDQUF2QixFQUEwQjtNQUN0QixLQUFLcEMsS0FBTCxHQUFlLENBQWY7SUFDSDs7SUFFRCxJQUFJLEtBQUtBLEtBQUwsR0FBYSxDQUFiLElBQWtCLEtBQUtjLEdBQTNCLEVBQWdDO01BQzVCZSxLQUFLLENBQUNPLENBQU4sR0FBVSxLQUFLbEMsU0FBZjtNQUNBLEtBQUtGLEtBQUw7SUFDSDs7SUFFRCxLQUFLYyxHQUFMLEdBQVcsS0FBWDtJQUNBLEtBQUtDLElBQUwsQ0FBVWUsY0FBVixHQUEyQkQsS0FBM0I7RUFDSDtBQTlHSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyIvLyBnYW1lIGFydCBmcm9tIDogaHR0cHM6Ly9vcGVucGl4ZWxwcm9qZWN0Lml0Y2guaW8vb3BwMjAxN3Nwcml0ZXNcblxuY29uc3QgTU9WRV9MRUZUID0gMTtcbmNvbnN0IE1PVkVfUklHSFQgPSAyO1xuXG5jYy5tYWNyby5FTkFCTEVfVElMRURNQVBfQ1VMTElORyA9IGZhbHNlO1xuXG5jYy5DbGFzcyh7XG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxuXG4gICAgcHJvcGVydGllczoge1xuICAgICAgICBtYXhTcGVlZDogNTAwLFxuICAgICAgICBqdW1wczogMixcbiAgICAgICAgYWNjZWxlcmF0aW9uOiAxNTAwLFxuICAgICAgICBqdW1wU3BlZWQ6IDIwMCxcbiAgICAgICAgZHJhZzogNjAwXG4gICAgfSxcblxuICAgIC8vIHVzZSB0aGlzIGZvciBpbml0aWFsaXphdGlvblxuICAgIG9uTG9hZDogZnVuY3Rpb24gKCkge1xuICAgICAgICBjYy5zeXN0ZW1FdmVudC5vbihjYy5TeXN0ZW1FdmVudC5FdmVudFR5cGUuS0VZX0RPV04sIHRoaXMub25LZXlEb3duLCB0aGlzKTtcbiAgICAgICAgY2Muc3lzdGVtRXZlbnQub24oY2MuU3lzdGVtRXZlbnQuRXZlbnRUeXBlLktFWV9VUCwgdGhpcy5vbktleVVwLCB0aGlzKTtcblxuICAgICAgICB0aGlzLl9tb3ZlRmxhZ3MgPSAwO1xuXG4gICAgICAgIHRoaXMuX3VwID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmJvZHkgPSB0aGlzLmdldENvbXBvbmVudChjYy5SaWdpZEJvZHkpO1xuICAgIH0sXG5cbiAgICBvbktleURvd24gKGV2ZW50KSB7XG4gICAgICAgIHN3aXRjaChldmVudC5rZXlDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIGNjLktFWS5hOlxuICAgICAgICAgICAgY2FzZSBjYy5LRVkubGVmdDpcbiAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlRmxhZ3MgfD0gTU9WRV9MRUZUO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjYy5LRVkuZDpcbiAgICAgICAgICAgIGNhc2UgY2MuS0VZLnJpZ2h0OlxuICAgICAgICAgICAgICAgIHRoaXMuX21vdmVGbGFncyB8PSBNT1ZFX1JJR0hUO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBjYy5LRVkudXA6XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl91cFByZXNzZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXAgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl91cFByZXNzZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uS2V5VXAgKGV2ZW50KSB7XG4gICAgICAgIHN3aXRjaChldmVudC5rZXlDb2RlKSB7XG4gICAgICAgICAgICBjYXNlIGNjLktFWS5hOlxuICAgICAgICAgICAgY2FzZSBjYy5LRVkubGVmdDpcbiAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlRmxhZ3MgJj0gfk1PVkVfTEVGVDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY2MuS0VZLmQ6XG4gICAgICAgICAgICBjYXNlIGNjLktFWS5yaWdodDpcbiAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlRmxhZ3MgJj0gfk1PVkVfUklHSFQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNjLktFWS51cDpcbiAgICAgICAgICAgICAgICB0aGlzLl91cFByZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH0sXG5cblxuICAgIC8vIGNhbGxlZCBldmVyeSBmcmFtZSwgdW5jb21tZW50IHRoaXMgZnVuY3Rpb24gdG8gYWN0aXZhdGUgdXBkYXRlIGNhbGxiYWNrXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoZHQpIHtcbiAgICAgICAgdmFyIHNwZWVkID0gdGhpcy5ib2R5LmxpbmVhclZlbG9jaXR5O1xuXG4gICAgICAgIGlmKHRoaXMuX21vdmVGbGFncyA9PT0gTU9WRV9MRUZUKSB7XG4gICAgICAgICAgICAvLyB0aGlzLmFuaW0ucGxheSgnd2FsaycpO1xuXG4gICAgICAgICAgICBpZih0aGlzLm5vZGUuc2NhbGVYID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zY2FsZVggKj0gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNwZWVkLnggLT0gdGhpcy5hY2NlbGVyYXRpb24gKiBkdDtcbiAgICAgICAgICAgIGlmKHNwZWVkLnggPCAtdGhpcy5tYXhTcGVlZCkge1xuICAgICAgICAgICAgICAgIHNwZWVkLnggPSAtdGhpcy5tYXhTcGVlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbW92ZUZsYWdzID09PSBNT1ZFX1JJR0hUKSB7XG4gICAgICAgICAgICAvLyB0aGlzLmFuaW0ucGxheSgnd2FsaycpO1xuXG4gICAgICAgICAgICBpZih0aGlzLm5vZGUuc2NhbGVYIDwgMCkge1xuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zY2FsZVggKj0gLTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNwZWVkLnggKz0gdGhpcy5hY2NlbGVyYXRpb24gKiBkdDtcbiAgICAgICAgICAgIGlmKHNwZWVkLnggPiB0aGlzLm1heFNwZWVkKSB7XG4gICAgICAgICAgICAgICAgc3BlZWQueCA9IHRoaXMubWF4U3BlZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gIFxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmKHNwZWVkLnggIT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5kcmFnICogZHQ7XG4gICAgICAgICAgICAgICAgaWYoTWF0aC5hYnMoc3BlZWQueCkgPD0gZCkge1xuICAgICAgICAgICAgICAgICAgICBzcGVlZC54ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5hbmltLnBsYXkoJ2lkbGUnKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzcGVlZC54IC09IHNwZWVkLnggPiAwID8gZCA6IC1kO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYoTWF0aC5hYnMoc3BlZWQueSkgPCAxKSB7XG4gICAgICAgICAgICB0aGlzLmp1bXBzICAgPSAyO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuanVtcHMgPiAwICYmIHRoaXMuX3VwKSB7XG4gICAgICAgICAgICBzcGVlZC55ID0gdGhpcy5qdW1wU3BlZWQ7XG4gICAgICAgICAgICB0aGlzLmp1bXBzLS07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl91cCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmJvZHkubGluZWFyVmVsb2NpdHkgPSBzcGVlZDtcbiAgICB9LFxufSk7XG4iXX0=