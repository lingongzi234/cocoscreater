{"version":3,"sources":["assets/cases/demo/ray-cast.js"],"names":["cc","Class","Component","properties","rayCastType","RayCastType","Closest","type","radius","onLoad","ctx","getComponent","Graphics","angle","center","v2","winSize","width","height","update","dt","Math","PI","p1","p2","cos","sin","mulSelf","addSelf","manager","director","getPhysicsManager","results","rayCast","clear","Any","point","forEach","result","circle","x","y","fill","moveTo","lineTo","stroke","onClosestBtnClick","onAnyBtnClick","onAllClosestBtnClick","AllClosest","onAllBtnClick","All"],"mappings":";;;;;;AAAAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASD,EAAE,CAACE,SADP;EAGLC,UAAU,EAAE;IACRC,WAAW,EAAE;MACT,WAASJ,EAAE,CAACK,WAAH,CAAeC,OADf;MAETC,IAAI,EAAEP,EAAE,CAACK;IAFA,CADL;IAMRG,MAAM,EAAE;EANA,CAHP;EAYL;EACAC,MAAM,EAAE,kBAAY;IAChB,KAAKC,GAAL,GAAW,KAAKC,YAAL,CAAkBX,EAAE,CAACY,QAArB,CAAX;IACA,KAAKC,KAAL,GAAa,CAAb;IACA,KAAKC,MAAL,GAAcd,EAAE,CAACe,EAAH,CAAMf,EAAE,CAACgB,OAAH,CAAWC,KAAX,GAAiB,CAAvB,EAA0BjB,EAAE,CAACgB,OAAH,CAAWE,MAAX,GAAkB,CAA5C,CAAd;EACH,CAjBI;EAmBL;EACAC,MAAM,EAAE,gBAAUC,EAAV,EAAc;IAAA;;IAClB,KAAKP,KAAL,IAAcQ,IAAI,CAACC,EAAL,GAAU,EAAV,GAAeF,EAA7B;IAEA,IAAIG,EAAE,GAAG,KAAKT,MAAd;IACA,IAAIU,EAAE,GAAGxB,EAAE,CAACe,EAAH,CAAMM,IAAI,CAACI,GAAL,CAAS,KAAKZ,KAAd,CAAN,EAA4BQ,IAAI,CAACK,GAAL,CAAS,KAAKb,KAAd,CAA5B,EAAkDc,OAAlD,CAA0D,KAAKnB,MAA/D,EAAuEoB,OAAvE,CAAgF,KAAKd,MAArF,CAAT;IAEA,IAAIe,OAAO,GAAG7B,EAAE,CAAC8B,QAAH,CAAYC,iBAAZ,EAAd;IACA,IAAIC,OAAO,GAAGH,OAAO,CAACI,OAAR,CAAgBV,EAAhB,EAAoBC,EAApB,EAAwB,KAAKpB,WAA7B,CAAd;IAEA,KAAKM,GAAL,CAASwB,KAAT;;IAEA,IAAI,KAAK9B,WAAL,KAAqBJ,EAAE,CAACK,WAAH,CAAeC,OAApC,IACA,KAAKF,WAAL,KAAqBJ,EAAE,CAACK,WAAH,CAAe8B,GADxC,EAC6C;MACzC,IAAIH,OAAO,CAAC,CAAD,CAAX,EAAgB;QACZR,EAAE,GAAGQ,OAAO,CAAC,CAAD,CAAP,CAAWI,KAAhB;MACH;IACJ;;IAEDJ,OAAO,CAACK,OAAR,CAAgB,UAAAC,MAAM,EAAI;MACtB,KAAI,CAAC5B,GAAL,CAAS6B,MAAT,CAAgBD,MAAM,CAACF,KAAP,CAAaI,CAA7B,EAAgCF,MAAM,CAACF,KAAP,CAAaK,CAA7C,EAAgD,CAAhD;IACH,CAFD;IAIA,KAAK/B,GAAL,CAASgC,IAAT;IAEA,KAAKhC,GAAL,CAASiC,MAAT,CAAgBpB,EAAE,CAACiB,CAAnB,EAAsBjB,EAAE,CAACkB,CAAzB;IACA,KAAK/B,GAAL,CAASkC,MAAT,CAAgBpB,EAAE,CAACgB,CAAnB,EAAsBhB,EAAE,CAACiB,CAAzB;IACA,KAAK/B,GAAL,CAASmC,MAAT;EACH,CA/CI;EAiDLC,iBAAiB,EAAE,6BAAY;IAC3B,KAAK1C,WAAL,GAAmBJ,EAAE,CAACK,WAAH,CAAeC,OAAlC;EACH,CAnDI;EAqDLyC,aAAa,EAAE,yBAAY;IACvB,KAAK3C,WAAL,GAAmBJ,EAAE,CAACK,WAAH,CAAe8B,GAAlC;EACH,CAvDI;EAyDLa,oBAAoB,EAAE,gCAAY;IAC9B,KAAK5C,WAAL,GAAmBJ,EAAE,CAACK,WAAH,CAAe4C,UAAlC;EACH,CA3DI;EA6DLC,aAAa,EAAE,yBAAY;IACvB,KAAK9C,WAAL,GAAmBJ,EAAE,CAACK,WAAH,CAAe8C,GAAlC;EACH;AA/DI,CAAT","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        rayCastType: {\n            default: cc.RayCastType.Closest,\n            type: cc.RayCastType\n        },\n\n        radius: 1000\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        this.ctx = this.getComponent(cc.Graphics);\n        this.angle = 0;\n        this.center = cc.v2(cc.winSize.width/2, cc.winSize.height/2);\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        this.angle += Math.PI / 10 * dt;\n\n        var p1 = this.center;\n        var p2 = cc.v2(Math.cos(this.angle), Math.sin(this.angle)).mulSelf(this.radius).addSelf( this.center );\n\n        var manager = cc.director.getPhysicsManager();\n        var results = manager.rayCast(p1, p2, this.rayCastType);\n\n        this.ctx.clear();\n\n        if (this.rayCastType === cc.RayCastType.Closest ||\n            this.rayCastType === cc.RayCastType.Any) {\n            if (results[0]) {\n                p2 = results[0].point;\n            }\n        }\n\n        results.forEach(result => {\n            this.ctx.circle(result.point.x, result.point.y, 5);\n        });    \n        \n        this.ctx.fill();\n\n        this.ctx.moveTo(p1.x, p1.y);\n        this.ctx.lineTo(p2.x, p2.y);\n        this.ctx.stroke();\n    },\n\n    onClosestBtnClick: function () {\n        this.rayCastType = cc.RayCastType.Closest;\n    },\n\n    onAnyBtnClick: function () {\n        this.rayCastType = cc.RayCastType.Any;\n    },\n\n    onAllClosestBtnClick: function () {\n        this.rayCastType = cc.RayCastType.AllClosest;\n    },\n\n    onAllBtnClick: function () {\n        this.rayCastType = cc.RayCastType.All;\n    }\n});\n"]}