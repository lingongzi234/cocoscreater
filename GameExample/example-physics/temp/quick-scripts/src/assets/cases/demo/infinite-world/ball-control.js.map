{"version":3,"sources":["assets/cases/demo/infinite-world/ball-control.js"],"names":["MOVE_LEFT","MOVE_RIGHT","cc","Class","Component","properties","maxSpeed","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","canvas","find","Node","TOUCH_START","onTouchStart","TOUCH_END","onTouchEnd","moveFlags","start","body","getComponent","RigidBody","event","keyCode","KEY","a","left","updateMotorSpeed","d","right","touchLoc","touch","getLocation","x","winSize","width","desiredSpeed","angularVelocity","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["const MOVE_LEFT = 1;\nconst MOVE_RIGHT = 2;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        maxSpeed: 1200\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n\n        var canvas = cc.find('/Canvas');\n        canvas.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\n        canvas.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n\n        this.moveFlags = 0;\n    },\n\n    start: function () {\n        this.body = this.getComponent(cc.RigidBody);\n    },\n\n    onKeyDown (event) {\n        switch(event.keyCode) {\n            case cc.KEY.a:\n            case cc.KEY.left:\n                this.moveFlags |= MOVE_LEFT;\n                this.updateMotorSpeed();\n                break;\n            case cc.KEY.d:\n            case cc.KEY.right:\n                this.moveFlags |= MOVE_RIGHT;\n                this.updateMotorSpeed();\n                break;\n        }\n    },\n\n    onKeyUp (event) {\n        switch(event.keyCode) {\n            case cc.KEY.a:\n            case cc.KEY.left:\n                this.moveFlags &= ~MOVE_LEFT;\n                // this.updateMotorSpeed();\n                break;\n            case cc.KEY.d:\n            case cc.KEY.right:\n                this.moveFlags &= ~MOVE_RIGHT;\n                // this.updateMotorSpeed();\n                break;\n        }\n    },\n\n    onTouchStart: function (event) {\n        let touchLoc = event.touch.getLocation();\n        if (touchLoc.x < cc.winSize.width/2) {\n            this.moveFlags |= MOVE_LEFT;\n        }\n        else {\n            this.moveFlags |= MOVE_RIGHT;\n        }\n        this.updateMotorSpeed();\n    },\n\n    onTouchEnd: function (event) {\n        let touchLoc = event.touch.getLocation();\n        if (touchLoc.x < cc.winSize.width/2) {\n            this.moveFlags &= ~MOVE_LEFT;\n        }\n        else {\n            this.moveFlags &= ~MOVE_RIGHT;\n        }\n        // this.updateMotorSpeed();\n    },\n\n    updateMotorSpeed () {\n        if ( !this.body )\n            return;\n        var desiredSpeed = 0;\n        if ( (this.moveFlags & MOVE_LEFT) == MOVE_LEFT )\n            desiredSpeed = -this.maxSpeed;\n        else if ( (this.moveFlags & MOVE_RIGHT) == MOVE_RIGHT )\n            desiredSpeed = this.maxSpeed;\n        this.body.angularVelocity = desiredSpeed;\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    update: function (dt) {\n        if (this.moveFlags) {\n            this.updateMotorSpeed();\n        }\n    },\n});\n"]}