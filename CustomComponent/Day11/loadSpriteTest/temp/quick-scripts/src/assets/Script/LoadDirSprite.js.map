{"version":3,"sources":["assets/Script/LoadDirSprite.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAsB,EAAE,CAAC,UAAU,EAAlC,OAAO,aAAA,EAAE,QAAQ,cAAiB,CAAC;AAG1C;IAAwC,8BAAY;IAApD;QAAA,qEAiIC;QA9HG,cAAQ,GAAY,IAAI,CAAC;QAGzB,eAAS,GAAY,IAAI,CAAC;QAG1B,WAAK,GAAa,IAAI,CAAC;QAGvB,WAAK,GAAa,IAAI,CAAC;;IAqH3B,CAAC;IAlHS,yCAAoB,GAA1B;;;;;;;wBACQ,SAAS,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;6BAC9B,IAAI,CAAC,QAAQ,EAAb,wBAAa;wBACb,qBAAM,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC;gCAC9C,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS,EAAE,UAAC,IAAI,EAAE,WAAW;oCACpD,IAAI,IAAI,EAAE;wCACN,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;qCACvB;yCAAM;wCACH,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,WAAW,EAAE,UAAC,IAAI,EAAE,KAAuB;4CACpE,IAAI,IAAI,EAAE;gDACN,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;6CACvB;iDAAM;gDACH,6CAA6C;gDAC7C,KAAI,CAAC,eAAe,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;6CAC1C;wCACL,CAAC,CAAC,CAAA;qCACL;gCACL,CAAC,CAAC,CAAA;4BACN,CAAC,CAAC,EAAA;;wBAfF,SAeE,CAAC;;;;;;KAEV;IAED,uCAAkB,GAAlB,UAAoB,IAAa;QAC7B,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YAC/B,IAAM,GAAG,GAAG,IAAI,CAAC,aAAa,CAAC;YAC/B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBAC1B,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,CAAC;aAC9B;YACD,UAAU,CAAC;gBACP,OAAO,CAAC,IAAI,CAAC,CAAA;YACjB,CAAC,EAAE,EAAE,CAAC,CAAC;QACX,CAAC,CAAC,CAAA;IACN,CAAC;IAED,yCAAoB,GAApB;QACI,IAAI,SAAS,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;QAClC,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,IAAI,CAAC,SAAS,CAAC,kBAAkB,EAAE,CAAC;SACvC;QAED,IAAI,MAAM,GAAG,EAAE,CAAC,YAAY,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAClD,IAAI,MAAM,EAAE;YACR,IAAI,YAAY,GAAG,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,EAAE,CAAC,WAAW,CAAqB,CAAC;YACnF,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzB,0CAA0C;gBAC1C,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;aACzD;SACJ;aAAM;YACH,kDAAkD;YAClD,IAAI,CAAC,wBAAwB,CAAC,SAAS,CAAC,CAAC;SAC5C;IACL,CAAC;IAED,6CAAwB,GAAxB,UAA0B,SAAiB;QAA3C,iBAcC;QAbG,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,SAAS,EAAE,UAAC,IAAI,EAAE,WAAW;YACpD,IAAI,IAAI,EAAE;gBACN,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;aACvB;iBAAM;gBACH,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,WAAW,EAAE,UAAC,IAAI,EAAE,KAAuB;oBACpE,IAAI,IAAI,EAAE;wBACN,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;qBACvB;yBAAM;wBACH,KAAI,CAAC,eAAe,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;qBAC1C;gBACL,CAAC,CAAC,CAAA;aACL;QACL,CAAC,CAAC,CAAA;IACN,CAAC;IAED,oCAAe,GAAf,UAAiB,IAAW,EAAE,SAAiB;QAC3C,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClC,IAAI,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;gBACzB,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;gBACjB,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;gBACnD,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBAC7B,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvB,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC;iBACpG;aACJ;SACJ;IACL,CAAC;IAED,mDAAmD;IACnD,2BAA2B;IAC3B,qDAAqD;IACrD,wCAAwC;IACxC,gCAAgC;IAChC,+DAA+D;IAC/D,4CAA4C;IAC5C,8CAA8C;IAC9C,oHAAoH;IACpH,mBAAmB;IACnB,eAAe;IACf,QAAQ;IACR,IAAI;IAEJ,oCAAe,GAAf,UAAiB,IAAW,EAAE,SAAiB,EAAE,MAA+B;QAC5E,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAClC,IAAI,IAAI,GAAG,IAAI,EAAE,CAAC,IAAI,EAAE,CAAC;gBACzB,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;gBACjB,IAAI,MAAM,EAAE;oBACR,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,WAAW,CAAC,CAAC;iBACvF;qBAAM;oBACH,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;iBACtD;gBACD,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBAC9B,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;oBACtB,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,gBAAgB,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC;iBACpG;aACJ;SACJ;IACL,CAAC;IA7HD;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;gDACO;IAGzB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;iDACQ;IAG1B;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6CACI;IAGvB;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;6CACI;IAZN,UAAU;QAD9B,OAAO;OACa,UAAU,CAiI9B;IAAD,iBAAC;CAjID,AAiIC,CAjIuC,EAAE,CAAC,SAAS,GAiInD;kBAjIoB,UAAU","file":"","sourceRoot":"/","sourcesContent":["const {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Helloworld extends cc.Component {\n\n    @property(cc.Node)\n    testNode: cc.Node = null;\n\n    @property(cc.Node)\n    testNode1: cc.Node = null;\n\n    @property(cc.Label)\n    tips0: cc.Label = null;\n\n    @property(cc.Label)\n    tips1: cc.Label = null;\n\n\n    async loadLocalBundleTest0 () {\n        let startTime = performance.now();\n        if (this.testNode) {\n            await this.destroyAllChildren(this.testNode).then(()=>{\n                cc.assetManager.loadBundle(\"kongfu0\", (err0, imageBundle)=>{\n                    if (err0) {\n                        console.error(err0);\n                    } else {\n                        imageBundle.loadDir(\"./\", cc.SpriteFrame, (err1, spfs0: [cc.SpriteFrame])=>{\n                            if (err1) {\n                                console.error(err1);\n                            } else {\n                                // setSpriteFrame0 接口中实现了对文件夹中所有图片的渲染以及加载时间输出\n                                this.setSpriteFrame0(spfs0, startTime);\n                            }\n                        })\n                    }\n                })\n            });\n        }\n    }\n\n    destroyAllChildren (node: cc.Node) {\n        return new Promise((resolve, reject) => {\n            const len = node.childrenCount;\n            for (let i = 0; i < len; i++) {\n                node.children[i].destroy();\n            }\n            setTimeout(() => {\n                resolve(null)\n            }, 10);\n        })\n    } \n\n    loadLocalBundleTest1 () {\n        let startTime = performance.now();\n        if (this.testNode1) {\n            this.testNode1.destroyAllChildren();\n        }\n        \n        var bundle = cc.assetManager.getBundle(\"kongfu1\");\n        if (bundle) {\n            var spriteFrames = bundle.getDirWithPath(\"./\", cc.SpriteFrame) as [cc.SpriteFrame];\n            if (spriteFrames.length > 0) {\n                // setSpriteFrame0 实现了对文件夹中所有图片的渲染以及加载时间输出\n                this.setSpriteFrame1(spriteFrames, startTime, bundle);\n            }\n        } else {\n            // 使用默认的异步加载 bundle 并加载 bundle 文件夹内的图片资源，成功后渲染所有图片\n            this.loadBundleAndSpriteFrame(startTime);\n        }\n    }\n\n    loadBundleAndSpriteFrame (startTime: number) {\n        cc.assetManager.loadBundle(\"kongfu1\", (err0, imageBundle)=>{\n            if (err0) {\n                console.error(err0);\n            } else {\n                imageBundle.loadDir(\"./\", cc.SpriteFrame, (err1, spfs1: [cc.SpriteFrame])=>{\n                    if (err1) {\n                        console.error(err1);\n                    } else {\n                        this.setSpriteFrame1(spfs1, startTime);\n                    }\n                })\n            }\n        })\n    }\n\n    setSpriteFrame0 (spfs: [any], startTime: number) {\n        if (this.testNode) {\n            for (let i = 0; i < spfs.length; i++) {\n                var node = new cc.Node();\n                node.scale = 0.2;\n                node.addComponent(cc.Sprite).spriteFrame = spfs[i];\n                this.testNode.addChild(node);\n                if (i === spfs.length - 1) {\n                    this.tips0.string = \"loadTime0 is: \" + Math.floor(1000 * (performance.now() - startTime)) / 1000;\n                }\n            }\n        }\n    }\n\n    // setSpriteFrame0 (spfs: any, startTime: number) {\n    //     if (this.testNode) {\n    //         // for (let i = 0; i < spfs.length; i++) {\n    //             var node = new cc.Node();\n    //             node.scale = 0.2;\n    //             node.addComponent(cc.Sprite).spriteFrame = spfs;\n    //             this.testNode.addChild(node);\n    //             // if (i === spfs.length - 1) {\n    //                 this.tips0.string = \"loadTime0 is: \" + Math.floor(1000 * (performance.now() - startTime)) / 1000;\n    //             // }\n    //         // }\n    //     }\n    // }\n\n    setSpriteFrame1 (spfs: [any], startTime: number, bundle?: cc.AssetManager.Bundle) {\n        if (this.testNode1) {\n            for (let i = 0; i < spfs.length; i++) {\n                var node = new cc.Node();\n                node.scale = 0.2;\n                if (bundle) {\n                    node.addComponent(cc.Sprite).spriteFrame = bundle.get(spfs[i].path, cc.SpriteFrame);\n                } else {\n                    node.addComponent(cc.Sprite).spriteFrame = spfs[i];\n                }\n                this.testNode1.addChild(node);\n                if (i == spfs.length - 1) {\n                    this.tips1.string = \"loadTime1 is: \" + Math.floor(1000 * (performance.now() - startTime)) / 1000;\n                }\n            }\n        }\n    }\n}\n"]}